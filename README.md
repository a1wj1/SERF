# SERF: Spatiotemporal-Aware Event-RGB Fusion for Steering Angle Prediction



## Install

```
conda env create -f environment.yml
```

Using our method requires modifying the underlying code of pytorch.

We have provided the modification file of torch==1.12.1+cu113 version.

Replace respectively:
`xxx/anaconda3/envs/py37/lib/python3.7/site-packages/torch/nn/modules/activation.py`

`xxx/anaconda3/envs/py37/lib/python3.7/site-packages/torch/nn/functional.py`



## Dataset

#### DDD20

You can visit the official website to learn more about the dataset in detail:

[DDD20 (google.com)](https://sites.google.com/view/davis-driving-dataset-2020/home)

Next, you can selectively download the data of one or more routes:

[libdrive (ethz.ch)](https://libdrive.ethz.ch/index.php/s/RK3thOJ5vfdmWen?p)

Finally, you can convert the video stream into the corresponding image data according to the official parsing code:

[SensorsINI/ddd20-utils: DDD20 End-to-End Event Camera Driving Dataset (github.com)](https://github.com/SensorsINI/ddd20-utils)



#### Carla

We have provided a download link for the Carla dataset:

link: https://pan.baidu.com/s/1MHCtjIgVzRS_IqtuWpgxOA?pwd=zyz2 Extraction code: zyz2 



## Generate CSV files

After obtaining the RGB and event image data, CSV files for training and testing can be generated based on the path of the images.

We have improved the Python file for generating sequence image paths. A CSV file can be generated by modifying the path and file name inside it:

```
python dataset/gen_data_ddd20_seq_csv.py
```



## Split the training set and the test set



We provide Python file for splitting the training set and the test set. You just need to modify the corresponding paths and run it:

```
python dataset/Split_data.py
```



## Train

By modifying the root_dir and running:

```
python train_serf_ddd20.py
```

or

```
python train_serf_carla.py
```
The script must run on two GPUs. You can modify the 'gpus=' parameter in pl.Trainer.from_argparse_args.


In addition, we also support training and evaluation of the DMR method [DMR]([Dmr: Decomposed multi-modality representations for frames and events fusion in visual reinforcement learning](https://ieeexplore.ieee.org/document/10656498))
```
python train_dmr_ddd20.py
```

## Test

By modifying the root_dir and logdir and running:

```
python test_serf_ddd20.py
```

or

```
python test_serf_carla.py
```

If this work is helpful for your research, please consider citing the following BibTeX entry:
```
@article{xia2025serf,
  title={SERF: Spatiotemporal-Aware Event-RGB Fusion for Steering Angle Prediction},
  author={Xia, Canming and Peng, Peixi and Xu, Haoran and Tan, Guang and Li, Luntong and Tian, Yonghong},
  journal={IEEE Transactions on Intelligent Transportation Systems},
  year={2025},
  publisher={IEEE}
}
```




## License

Open the source code after the paper is published and made public.
